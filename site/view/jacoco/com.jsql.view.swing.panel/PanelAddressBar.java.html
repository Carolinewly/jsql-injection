<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PanelAddressBar.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">view</a> &gt; <a href="index.source.html" class="el_package">com.jsql.view.swing.panel</a> &gt; <span class="el_source">PanelAddressBar.java</span></div><h1>PanelAddressBar.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * Copyhacked (H) 2012-2020.
 * This program and the accompanying materials
 * are made available under no term at all, use it like
 * you want, but share and discuss about it
 * every time possible with every body.
 * 
 * Contributors:
 *      ron190 at ymail dot com - initial implementation
 ******************************************************************************/
package com.jsql.view.swing.panel;

import com.jsql.model.injection.method.AbstractMethodInjection;
import com.jsql.util.I18nUtil;
import com.jsql.view.swing.panel.address.ActionEnterAddressBar;
import com.jsql.view.swing.panel.address.AddressMenuBar;
import com.jsql.view.swing.panel.address.RequestPanel;
import com.jsql.view.swing.panel.util.ButtonExpandText;
import com.jsql.view.swing.radio.RadioLinkMethod;
import com.jsql.view.swing.text.*;
import com.jsql.view.swing.ui.ComponentBorder;
import com.jsql.view.swing.util.I18nViewUtil;
import com.jsql.view.swing.util.MediatorHelper;
import com.jsql.view.swing.util.UiUtil;

import javax.swing.*;
import javax.swing.plaf.basic.BasicArrowButton;
import java.awt.*;
import java.util.stream.Stream;

/**
 * Create panel at the top of the window.
 * Contains textfields in a panel.
 */
public class PanelAddressBar extends JPanel {
    
    private final JTextField textFieldAddress;
    private final JTextField textFieldRequest;
    private final JTextField textFieldHeader;

<span class="fc" id="L41">    private final RadioLinkMethod[] radioQueryString = new RadioLinkMethod[1];</span>
<span class="fc" id="L42">    private final RadioLinkMethod[] radioRequest = new RadioLinkMethod[1];</span>
<span class="fc" id="L43">    private final RadioLinkMethod[] radioHeader = new RadioLinkMethod[1];</span>
    
    private static final String KEY_TOOLTIP_QUERY = &quot;FIELD_QUERYSTRING_TOOLTIP&quot;;
    private static final String KEY_TOOLTIP_REQUEST = &quot;FIELD_REQUEST_TOOLTIP&quot;;
    private static final String KEY_TOOLTIP_HEADER = &quot;FIELD_HEADER_TOOLTIP&quot;;

    // Current injection method.
<span class="fc" id="L50">    private AbstractMethodInjection methodInjection = MediatorHelper.model().getMediatorMethod().getQuery();</span>

    private final AddressMenuBar addressMenuBar;
    private final RequestPanel requestPanel;

<span class="fc" id="L55">    private boolean isAdvanceActivated = false;</span>
    
<span class="fc" id="L57">    public PanelAddressBar() {</span>
        
<span class="fc" id="L59">        this.setBorder(BorderFactory.createMatteBorder(1, 0, 0, 0, UiUtil.COLOR_COMPONENT_BORDER));</span>
        
<span class="fc" id="L61">        final var tooltipQuery = new JToolTipI18n[]{ new JToolTipI18n(I18nUtil.valueByKey(KEY_TOOLTIP_QUERY)) };</span>
<span class="fc" id="L62">        JTextFieldWithIcon fieldWithIcon = new JTextFieldWithIcon(I18nUtil.valueByKey(&quot;ADDRESS_BAR&quot;)) {</span>
            
            @Override
            public JToolTip createToolTip() {
                
<span class="nc" id="L67">                JToolTipI18n tipI18n = new JToolTipI18n(I18nUtil.valueByKey(KEY_TOOLTIP_QUERY));</span>
<span class="nc" id="L68">                tooltipQuery[0] = tipI18n;</span>
<span class="nc" id="L69">                return tipI18n;</span>
            }
        };
<span class="fc" id="L72">        this.textFieldAddress = new JTextFieldAddressBar(fieldWithIcon).getProxy();</span>
<span class="fc" id="L73">        I18nViewUtil.addComponentForKey(&quot;ADDRESS_BAR&quot;, fieldWithIcon);</span>
<span class="fc" id="L74">        I18nViewUtil.addComponentForKey(KEY_TOOLTIP_QUERY, tooltipQuery[0]);</span>
        
<span class="fc" id="L76">        this.textFieldAddress.setName(&quot;textFieldAddress&quot;);</span>
        
<span class="fc" id="L78">        final var tooltipRequest = new JToolTipI18n[]{ new JToolTipI18n(I18nUtil.valueByKey(KEY_TOOLTIP_REQUEST)) };</span>
<span class="fc" id="L79">        this.textFieldRequest = new JPopupTextField(new JTextFieldPlaceholder(&quot;e.g. key=value&amp;injectMe=&quot;) {</span>
            
            @Override
            public JToolTip createToolTip() {
                
<span class="nc" id="L84">                JToolTipI18n tipI18n = new JToolTipI18n(I18nUtil.valueByKey(KEY_TOOLTIP_REQUEST));</span>
<span class="nc" id="L85">                tooltipRequest[0] = tipI18n;</span>
<span class="nc" id="L86">                return tipI18n;</span>
            }
<span class="fc" id="L88">        }).getProxy();</span>
<span class="fc" id="L89">        I18nViewUtil.addComponentForKey(KEY_TOOLTIP_REQUEST, tooltipRequest[0]);</span>
        
<span class="fc" id="L91">        final var tooltipHeader = new JToolTipI18n[]{ new JToolTipI18n(I18nUtil.valueByKey(KEY_TOOLTIP_HEADER)) };</span>
<span class="fc" id="L92">        this.textFieldHeader = new JPopupTextField(new JTextFieldPlaceholder(&quot;e.g. key: value\\r\\nCookie: cKey1=cValue1; cKey2=cValue2\\r\\nAuthorization: Basic dXNlcjpwYXNz\\r\\ninjectMe:&quot;) {</span>
            
            @Override
            public JToolTip createToolTip() {
                
<span class="nc" id="L97">                JToolTipI18n tipI18n = new JToolTipI18n(I18nUtil.valueByKey(KEY_TOOLTIP_HEADER));</span>
<span class="nc" id="L98">                tooltipHeader[0] = tipI18n;</span>
                
<span class="nc" id="L100">                return tooltipHeader[0];</span>
            }
<span class="fc" id="L102">        }).getProxy();</span>
<span class="fc" id="L103">        I18nViewUtil.addComponentForKey(KEY_TOOLTIP_HEADER, tooltipHeader[0]);</span>
        
<span class="fc" id="L105">        Stream.of(</span>
<span class="fc" id="L106">            new RadioModel(&quot;URL&quot;, true, MediatorHelper.model().getMediatorMethod().getQuery(), &quot;METHOD_QUERYSTRING_TOOLTIP&quot;, this.radioQueryString),</span>
<span class="fc" id="L107">            new RadioModel(&quot;GET&quot;, false, MediatorHelper.model().getMediatorMethod().getRequest(), &quot;METHOD_REQUEST_TOOLTIP&quot;, this.radioRequest),</span>
<span class="fc" id="L108">            new RadioModel(&quot;Header&quot;, false, MediatorHelper.model().getMediatorMethod().getHeader(), &quot;METHOD_HEADER_TOOLTIP&quot;, this.radioHeader)</span>
        )
<span class="fc" id="L110">        .forEach(radioModel -&gt; {</span>
            
<span class="fc" id="L112">            var tooltip = new JToolTipI18n[]{ new JToolTipI18n(I18nUtil.valueByKey(radioModel.i18n)) };</span>
<span class="fc" id="L113">            radioModel.radio[0] = new RadioLinkMethod(radioModel.request, radioModel.isSelected, radioModel.method) {</span>
                
                @Override
                public JToolTip createToolTip() {
                    
<span class="nc" id="L118">                    tooltip[0] = new JToolTipI18n(I18nUtil.valueByKey(radioModel.i18n));</span>
                    
<span class="nc" id="L120">                    return tooltip[0];</span>
                }
            };
<span class="fc" id="L123">            I18nViewUtil.addComponentForKey(radioModel.i18n, tooltip[0]);</span>
            
<span class="fc" id="L125">            radioModel.radio[0].setToolTipText(I18nUtil.valueByKey(radioModel.i18n));</span>
<span class="fc" id="L126">        });</span>
                
<span class="fc" id="L128">        this.requestPanel = new RequestPanel(this);</span>

<span class="fc" id="L130">        this.radioQueryString[0].setBorder(BorderFactory.createEmptyBorder(0, 3, 0, 3));</span>
<span class="fc" id="L131">        this.requestPanel.setBorder(BorderFactory.createEmptyBorder(6, 3, 0, 3));</span>
<span class="fc" id="L132">        this.radioHeader[0].setBorder(BorderFactory.createEmptyBorder(6, 3, 0, 3));</span>

        // Tooltip setting
<span class="fc" id="L135">        this.textFieldAddress.setToolTipText(I18nUtil.valueByKey(KEY_TOOLTIP_QUERY));</span>
<span class="fc" id="L136">        this.textFieldRequest.setToolTipText(I18nUtil.valueByKey(KEY_TOOLTIP_REQUEST));</span>
<span class="fc" id="L137">        this.textFieldHeader.setToolTipText(I18nUtil.valueByKey(KEY_TOOLTIP_HEADER));</span>

        /**
         * Define UI and the left padding for addressBar
         */
<span class="fc" id="L142">        this.textFieldAddress.setBorder(</span>
<span class="fc" id="L143">            BorderFactory.createCompoundBorder(</span>
<span class="fc" id="L144">                BorderFactory.createCompoundBorder(</span>
<span class="fc" id="L145">                    BorderFactory.createMatteBorder(4, 2, 3, 0, UiUtil.COLOR_DEFAULT_BACKGROUND),</span>
<span class="fc" id="L146">                    BorderFactory.createLineBorder(UiUtil.COLOR_BLU)</span>
                ),
<span class="fc" id="L148">                BorderFactory.createEmptyBorder(2, 23, 2, 23)</span>
            )
        );

<span class="fc" id="L152">        this.textFieldRequest.setBorder(</span>
<span class="fc" id="L153">            BorderFactory.createCompoundBorder(</span>
<span class="fc" id="L154">                BorderFactory.createMatteBorder(1, 2, 0, 0, UiUtil.COLOR_DEFAULT_BACKGROUND),</span>
                UiUtil.BORDER_BLU
            )
        );
        
<span class="fc" id="L159">        this.textFieldHeader.setBorder(</span>
<span class="fc" id="L160">            BorderFactory.createCompoundBorder(</span>
<span class="fc" id="L161">                BorderFactory.createMatteBorder(1, 2, 0, 0, UiUtil.COLOR_DEFAULT_BACKGROUND),</span>
                UiUtil.BORDER_BLU
            )
        );

<span class="fc" id="L166">        this.textFieldRequest.setPreferredSize(new Dimension(0, 27));</span>
<span class="fc" id="L167">        this.textFieldRequest.setFont(UiUtil.FONT_NON_MONO_BIG);</span>
<span class="fc" id="L168">        this.textFieldHeader.setPreferredSize(new Dimension(0, 27));</span>
<span class="fc" id="L169">        this.textFieldHeader.setFont(UiUtil.FONT_NON_MONO_BIG);</span>

<span class="fc" id="L171">        this.textFieldAddress.addActionListener(new ActionEnterAddressBar(this));</span>
<span class="fc" id="L172">        this.textFieldRequest.addActionListener(new ActionEnterAddressBar(this));</span>
<span class="fc" id="L173">        this.textFieldHeader.addActionListener(new ActionEnterAddressBar(this));</span>

<span class="fc" id="L175">        this.addressMenuBar = new AddressMenuBar(this);</span>
<span class="fc" id="L176">        new ComponentBorder(this.addressMenuBar, 17, 0).install(this.textFieldAddress);</span>

<span class="fc" id="L178">        new ComponentBorder(new ButtonExpandText(&quot;Request body&quot;, this.textFieldRequest), 0, 0).install(this.textFieldRequest);</span>
<span class="fc" id="L179">        new ComponentBorder(new ButtonExpandText(&quot;Header body&quot;, this.textFieldHeader), 0, 0).install(this.textFieldHeader);</span>

<span class="fc" id="L181">        this.radioQueryString[0].setVisible(false);</span>
<span class="fc" id="L182">        this.textFieldRequest.setVisible(false);</span>
<span class="fc" id="L183">        this.requestPanel.setVisible(false);</span>
<span class="fc" id="L184">        this.textFieldHeader.setVisible(false);</span>
<span class="fc" id="L185">        this.radioHeader[0].setVisible(false);</span>
        
<span class="fc" id="L187">        this.initializeLayout();</span>
<span class="fc" id="L188">    }</span>

    private void initializeLayout() {
        
<span class="fc" id="L192">        final BasicArrowButton advancedButton = this.initializeAdvancedButton(this.requestPanel);</span>
        
        // Vertical positioning for components
<span class="fc" id="L195">        this.setLayout(new BoxLayout(this, BoxLayout.PAGE_AXIS));</span>
        
        // First panel at the top, contains text components
<span class="fc" id="L198">        var panelTextFields = new JPanel();</span>
<span class="fc" id="L199">        var layoutTextFields = new GroupLayout(panelTextFields);</span>
<span class="fc" id="L200">        panelTextFields.setLayout(layoutTextFields);</span>
<span class="fc" id="L201">        panelTextFields.setBorder(BorderFactory.createEmptyBorder(2, 2, 2, 0));</span>
<span class="fc" id="L202">        this.add(panelTextFields);</span>

        // Horizontal column rules
<span class="fc" id="L205">        layoutTextFields</span>
<span class="fc" id="L206">        .setHorizontalGroup(</span>
            layoutTextFields
<span class="fc" id="L208">            .createSequentialGroup()</span>
<span class="fc" id="L209">            .addGroup(</span>
                layoutTextFields
<span class="fc" id="L211">                .createParallelGroup(GroupLayout.Alignment.TRAILING, false)</span>
<span class="fc" id="L212">                .addComponent(this.radioQueryString[0])</span>
<span class="fc" id="L213">                .addComponent(this.requestPanel)</span>
<span class="fc" id="L214">                .addComponent(this.radioHeader[0])</span>
            )
<span class="fc" id="L216">            .addGroup(</span>
                layoutTextFields
<span class="fc" id="L218">                .createParallelGroup()</span>
<span class="fc" id="L219">                .addComponent(this.textFieldAddress)</span>
<span class="fc" id="L220">                .addComponent(this.textFieldRequest)</span>
<span class="fc" id="L221">                .addComponent(this.textFieldHeader)</span>
            )
<span class="fc" id="L223">            .addGroup(</span>
                layoutTextFields
<span class="fc" id="L225">                .createParallelGroup(GroupLayout.Alignment.LEADING, false)</span>
<span class="fc" id="L226">                .addComponent(advancedButton)</span>
            )
        );

        // Vertical line rules
<span class="fc" id="L231">        layoutTextFields</span>
<span class="fc" id="L232">        .setVerticalGroup(</span>
            layoutTextFields
<span class="fc" id="L234">            .createSequentialGroup()</span>
<span class="fc" id="L235">            .addGroup(</span>
                layoutTextFields
<span class="fc" id="L237">                .createParallelGroup(GroupLayout.Alignment.CENTER, false)</span>
<span class="fc" id="L238">                .addComponent(this.radioQueryString[0])</span>
<span class="fc" id="L239">                .addComponent(this.textFieldAddress)</span>
<span class="fc" id="L240">                .addComponent(advancedButton)</span>
            )
<span class="fc" id="L242">            .addGroup(</span>
                layoutTextFields
<span class="fc" id="L244">                .createParallelGroup(GroupLayout.Alignment.BASELINE)</span>
<span class="fc" id="L245">                .addComponent(this.requestPanel)</span>
<span class="fc" id="L246">                .addComponent(this.textFieldRequest)</span>
            )
<span class="fc" id="L248">            .addGroup(</span>
                layoutTextFields
<span class="fc" id="L250">                .createParallelGroup(GroupLayout.Alignment.BASELINE)</span>
<span class="fc" id="L251">                .addComponent(this.radioHeader[0])</span>
<span class="fc" id="L252">                .addComponent(this.textFieldHeader)</span>
            )
        );
<span class="fc" id="L255">    }</span>

    private BasicArrowButton initializeAdvancedButton(final JPanel panelHttpProtocol) {
        
<span class="fc" id="L259">        final var advancedButton = new BasicArrowButton(SwingConstants.SOUTH);</span>
<span class="fc" id="L260">        advancedButton.setName(&quot;advancedButton&quot;);</span>
<span class="fc" id="L261">        advancedButton.setBorderPainted(false);</span>
<span class="fc" id="L262">        advancedButton.setOpaque(false);</span>

<span class="fc" id="L264">        advancedButton.setToolTipText(I18nUtil.valueByKey(&quot;BUTTON_ADVANCED&quot;));</span>
<span class="fc" id="L265">        advancedButton.addActionListener(actionEvent -&gt; {</span>
            
<span class="fc bfc" id="L267" title="All 2 branches covered.">            boolean isVisible = advancedButton.getDirection() == SwingConstants.SOUTH;</span>

<span class="fc" id="L269">            this.radioQueryString[0].setVisible(isVisible);</span>

<span class="fc" id="L271">            PanelAddressBar.this.textFieldRequest.setVisible(isVisible);</span>
<span class="fc" id="L272">            panelHttpProtocol.setVisible(isVisible);</span>

<span class="fc" id="L274">            PanelAddressBar.this.textFieldHeader.setVisible(isVisible);</span>
<span class="fc" id="L275">            this.radioHeader[0].setVisible(isVisible);</span>
            
<span class="fc" id="L277">            this.isAdvanceActivated = isVisible;</span>
<span class="fc" id="L278">            MediatorHelper.menubar().setVisible(isVisible);</span>

<span class="fc bfc" id="L280" title="All 2 branches covered.">            advancedButton.setDirection(isVisible ? SwingConstants.NORTH : SwingConstants.SOUTH);</span>
<span class="fc" id="L281">        });</span>
        
<span class="fc" id="L283">        return advancedButton;</span>
    }
    
    private static class RadioModel {
        
        private final String request;
        private final Boolean isSelected;
        private final AbstractMethodInjection method;
        private final String i18n;
        private final RadioLinkMethod[] radio;

<span class="fc" id="L294">        public RadioModel(String request, Boolean isSelected, AbstractMethodInjection method, String i18n, RadioLinkMethod[] radio) {</span>
            
<span class="fc" id="L296">            this.request = request;</span>
<span class="fc" id="L297">            this.isSelected = isSelected;</span>
<span class="fc" id="L298">            this.method = method;</span>
<span class="fc" id="L299">            this.i18n = i18n;</span>
<span class="fc" id="L300">            this.radio = radio;</span>
<span class="fc" id="L301">        }</span>
    }
    
    
    // Getter and setter

    public void setMethodInjection(AbstractMethodInjection methodInjection) {
<span class="fc" id="L308">        this.methodInjection = methodInjection;</span>
<span class="fc" id="L309">    }</span>

    public JTextField getTextFieldAddress() {
<span class="fc" id="L312">        return this.textFieldAddress;</span>
    }

    public boolean isAdvanceActivated() {
<span class="fc" id="L316">        return this.isAdvanceActivated;</span>
    }

    public JTextField getTextFieldRequest() {
<span class="fc" id="L320">        return this.textFieldRequest;</span>
    }

    public JTextField getTextFieldHeader() {
<span class="fc" id="L324">        return this.textFieldHeader;</span>
    }

    public RadioLinkMethod getRadioQueryString() {
<span class="fc" id="L328">        return this.radioQueryString[0];</span>
    }

    public RadioLinkMethod getRadioHeader() {
<span class="nc" id="L332">        return this.radioHeader[0];</span>
    }

    public RadioLinkMethod getRadioRequest() {
<span class="fc" id="L336">        return this.radioRequest[0];</span>
    }

    public AbstractMethodInjection getMethodInjection() {
<span class="fc" id="L340">        return this.methodInjection;</span>
    }

    public AddressMenuBar getAddressMenuBar() {
<span class="fc" id="L344">        return this.addressMenuBar;</span>
    }

    public RequestPanel getRequestPanel() {
<span class="fc" id="L348">        return this.requestPanel;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>