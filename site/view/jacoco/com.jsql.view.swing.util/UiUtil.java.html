<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>UiUtil.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">view</a> &gt; <a href="index.source.html" class="el_package">com.jsql.view.swing.util</a> &gt; <span class="el_source">UiUtil.java</span></div><h1>UiUtil.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * Copyhacked (H) 2012-2020.
 * This program and the accompanying materials
 * are made available under no term at all, use it like
 * you want, but share and discuss about it
 * every time possible with every body.
 * 
 * Contributors:
 *      ron190 at ymail dot com - initial implementation
 ******************************************************************************/
package com.jsql.view.swing.util;

import com.jsql.util.LogLevelUtil;
import com.jsql.view.swing.sql.lexer.HighlightedDocument;
import com.jsql.view.swing.text.action.DeleteNextCharAction;
import com.jsql.view.swing.text.action.DeletePrevCharAction;
import com.jsql.view.swing.ui.BorderRoundBlu;
import com.jsql.view.swing.ui.CheckBoxIcon;
import com.jsql.view.swing.ui.CustomBasicComboBoxUI;
import org.apache.commons.lang3.SystemUtils;
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

import javax.imageio.ImageIO;
import javax.swing.*;
import javax.swing.border.AbstractBorder;
import javax.swing.border.Border;
import javax.swing.border.LineBorder;
import javax.swing.plaf.ColorUIResource;
import javax.swing.text.DefaultCaret;
import javax.swing.text.DefaultEditorKit;
import javax.swing.text.JTextComponent;
import java.awt.*;
import java.awt.event.FocusEvent;
import java.awt.event.FocusListener;
import java.awt.image.BufferedImage;
import java.io.BufferedInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;
import java.util.Objects;

/**
 * Build default component appearance, keyboard shortcuts and icons.
 */
public class UiUtil {
    
    /**
     * Log4j logger sent to view.
     */
<span class="fc" id="L53">    private static final Logger LOGGER = LogManager.getRootLogger();</span>

<span class="fc" id="L55">    public static final Color COLOR_BLU = new Color(132, 172, 221);</span>
<span class="fc" id="L56">    public static final Color COLOR_GREEN = new Color(0, 128, 0);</span>
    public static final String TEXTPANE_FONT = &quot;TextPane.font&quot;;

    // Color TabbedPane.selected hardcoded for Mac value is missing
<span class="fc" id="L60">    public static final Color COLOR_FOCUS_GAINED = new Color(200, 221, 242);</span>
    
<span class="fc" id="L62">    public static final Color COLOR_DEFAULT_BACKGROUND = UIManager.getColor(&quot;Panel.background&quot;);</span>
<span class="fc" id="L63">    public static final Color COLOR_COMPONENT_BORDER = UIManager.getColor(&quot;controlShadow&quot;);</span>
<span class="fc" id="L64">    public static final Color COLOR_FOCUS_LOST = new Color(248, 249, 249);</span>
<span class="fc" id="L65">    public static final Border BORDER_FOCUS_LOST = new LineBorder(new Color(218, 218, 218), 1, false);</span>
<span class="fc" id="L66">    public static final Border BORDER_FOCUS_GAINED = new LineBorder(UiUtil.COLOR_COMPONENT_BORDER, 1, false);</span>
    
<span class="fc" id="L68">    public static final URL URL_GLOBE = UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/globe.png&quot;);</span>
    
<span class="fc" id="L70">    public static final Icon ICON_TICK = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/check.png&quot;)));</span>
<span class="fc" id="L71">    public static final Icon ICON_SQUARE_RED = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/squareRed.png&quot;)));</span>
<span class="fc" id="L72">    public static final Icon ICON_SQUARE_GREY = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/squareGrey.png&quot;)));</span>
<span class="fc" id="L73">    public static final Icon ICON_LOADER_GIF = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/spinner.gif&quot;)));</span>

<span class="fc" id="L75">    public static final Icon ICON_ADMIN_SERVER = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/admin.png&quot;)));</span>
<span class="fc" id="L76">    public static final Icon ICON_SHELL_SERVER = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/application_xp_terminal.png&quot;)));</span>
<span class="fc" id="L77">    public static final Icon ICON_DATABASE_SERVER = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/database.png&quot;)));</span>
<span class="fc" id="L78">    public static final Icon ICON_FILE_SERVER = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/file.png&quot;)));</span>
<span class="fc" id="L79">    public static final Icon ICON_COG = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/cog.png&quot;)));</span>
<span class="fc" id="L80">    public static final Icon ICON_BRUTER = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/lock_open.png&quot;)));</span>
<span class="fc" id="L81">    public static final Icon ICON_CODER = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/textfield.png&quot;)));</span>
<span class="fc" id="L82">    public static final Icon ICON_UPLOAD = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/disk.png&quot;)));</span>
<span class="fc" id="L83">    public static final Icon ICON_SCANLIST = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/table_multiple.png&quot;)));</span>

<span class="fc" id="L85">    public static final Icon ICON_TABLE = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/table.png&quot;)));</span>
<span class="fc" id="L86">    public static final Icon ICON_TABLE_GO = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/tableGo.png&quot;)));</span>
<span class="fc" id="L87">    public static final Icon ICON_DATABASE = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/database.png&quot;)));</span>
<span class="fc" id="L88">    public static final Icon ICON_DATABASE_GO = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/databaseGo.png&quot;)));</span>
    
<span class="fc" id="L90">    public static final Icon ICON_CONSOLE = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/console.gif&quot;)));</span>
<span class="fc" id="L91">    public static final Icon ICON_HEADER = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/header.gif&quot;)));</span>
<span class="fc" id="L92">    public static final Icon ICON_CHUNK = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/chunk.gif&quot;)));</span>
<span class="fc" id="L93">    public static final Icon ICON_BINARY = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/binary.gif&quot;)));</span>
<span class="fc" id="L94">    public static final Icon ICON_CUP = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/cup.png&quot;)));</span>
    
<span class="fc" id="L96">    public static final Icon ICON_CLOSE = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/close.png&quot;)));</span>
<span class="fc" id="L97">    public static final Icon ICON_CLOSE_ROLLOVER = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/closeRollover.png&quot;)));</span>
<span class="fc" id="L98">    public static final Icon ICON_CLOSE_PRESSED = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/closePressed.png&quot;)));</span>

<span class="fc" id="L100">    public static final Icon ICON_ARROW_DEFAULT = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/arrowDefault.png&quot;)));</span>
<span class="fc" id="L101">    public static final Icon ICON_ARROW_ROLLOVER = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/arrowRollover.png&quot;)));</span>
<span class="fc" id="L102">    public static final Icon ICON_ARROW_PRESSED = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/arrowPressed.png&quot;)));</span>

<span class="fc" id="L104">    public static final Icon ICON_EXPAND_TEXT = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/expand.png&quot;)));</span>

<span class="fc" id="L106">    public static final Icon ICON_FLAG_AR = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/ar.png&quot;)));</span>
<span class="fc" id="L107">    public static final Icon ICON_FLAG_ZH = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/zh.png&quot;)));</span>
<span class="fc" id="L108">    public static final Icon ICON_FLAG_RU = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/ru.png&quot;)));</span>
<span class="fc" id="L109">    public static final Icon ICON_FLAG_TR = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/tr.png&quot;)));</span>
<span class="fc" id="L110">    public static final Icon ICON_FLAG_EN = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/en.png&quot;)));</span>
<span class="fc" id="L111">    public static final Icon ICON_FLAG_FR = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/fr.png&quot;)));</span>
<span class="fc" id="L112">    public static final Icon ICON_FLAG_HI = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/hi.png&quot;)));</span>
<span class="fc" id="L113">    public static final Icon ICON_FLAG_CS = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/cs.png&quot;)));</span>
<span class="fc" id="L114">    public static final Icon ICON_FLAG_DE = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/de.png&quot;)));</span>
<span class="fc" id="L115">    public static final Icon ICON_FLAG_NL = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/nl.png&quot;)));</span>
<span class="fc" id="L116">    public static final Icon ICON_FLAG_IN_ID = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/id.png&quot;)));</span>
<span class="fc" id="L117">    public static final Icon ICON_FLAG_IT = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/it.png&quot;)));</span>
<span class="fc" id="L118">    public static final Icon ICON_FLAG_ES = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/es.png&quot;)));</span>
<span class="fc" id="L119">    public static final Icon ICON_FLAG_PT = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/pt.png&quot;)));</span>
<span class="fc" id="L120">    public static final Icon ICON_FLAG_PL = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/pl.png&quot;)));</span>
<span class="fc" id="L121">    public static final Icon ICON_FLAG_JA = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/ja.png&quot;)));</span>
<span class="fc" id="L122">    public static final Icon ICON_FLAG_KO = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/ko.png&quot;)));</span>
<span class="fc" id="L123">    public static final Icon ICON_FLAG_RO = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/ro.png&quot;)));</span>
<span class="fc" id="L124">    public static final Icon ICON_FLAG_LK = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/lk.png&quot;)));</span>
<span class="fc" id="L125">    public static final Icon ICON_FLAG_SE = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/se.png&quot;)));</span>
<span class="fc" id="L126">    public static final Icon ICON_FLAG_FI = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/flags/fi.png&quot;)));</span>
    
<span class="fc" id="L128">    public static final URL URL_ICON_16 = UiUtil.class.getClassLoader().getResource(&quot;swing/images/software/bug16.png&quot;);</span>
<span class="fc" id="L129">    public static final URL URL_ICON_32 = UiUtil.class.getClassLoader().getResource(&quot;swing/images/software/bug32.png&quot;);</span>
<span class="fc" id="L130">    public static final URL URL_ICON_96 = UiUtil.class.getClassLoader().getResource(&quot;swing/images/software/bug96.png&quot;);</span>
<span class="fc" id="L131">    public static final URL URL_ICON_128 = UiUtil.class.getClassLoader().getResource(&quot;swing/images/software/bug128.png&quot;);</span>

    // The drop shadow is created from a PNG image with 8 bit alpha channel.
<span class="fc" id="L134">    public static final Image IMG_SHADOW = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/shadow.png&quot;))).getImage();</span>
    
<span class="fc" id="L136">    public static final ImageIcon IMG_BUG = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/bug.png&quot;)));</span>
<span class="fc" id="L137">    public static final ImageIcon IMG_STOP_DEFAULT = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/stopDefault.png&quot;)));</span>
<span class="fc" id="L138">    public static final ImageIcon IMG_STOP_ROLLOVER = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/stopRollover.png&quot;)));</span>
<span class="fc" id="L139">    public static final ImageIcon IMG_STOP_PPRESSED = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/stopPressed.png&quot;)));</span>
    
    public static final String PATH_WEB_FOLDERS = &quot;swing/list/payload.txt&quot;;
    public static final String INPUT_STREAM_PAGES_SCAN = &quot;swing/list/scan-page.json&quot;;

    // Set a margin on menu item on non Mac OS
<span class="fc" id="L145">    public static final Icon ICON_EMPTY = new ImageIcon(new BufferedImage(16, 16, Transparency.TRANSLUCENT));</span>

    public static final String PATH_PAUSE = &quot;swing/images/icons/pause.png&quot;;
    public static final String PATH_PROGRESSBAR = &quot;swing/images/icons/progressBar.gif&quot;;
    
<span class="fc" id="L150">    public static final Icon ICON_ERROR = new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/error.png&quot;)));</span>
    
<span class="fc" id="L152">    public static final Border BORDER_BLU = BorderFactory.createCompoundBorder(</span>
        BORDER_FOCUS_GAINED,
<span class="fc" id="L154">        BorderFactory.createEmptyBorder(2, 2, 2, 2)</span>
    );
    
<span class="fc" id="L157">    public static final Border BORDER_ROUND_BLU = new BorderRoundBlu();</span>

    public static final String FONT_NAME_MONO_NON_ASIAN = &quot;Ubuntu Mono&quot;;
    public static final int FONT_SIZE_MONO_NON_ASIAN = 14;
    public static final String FONT_NAME_MONO_ASIAN = &quot;Monospace&quot;;
    public static final int FONT_SIZE_MONO_ASIAN = 13;
    
    // Used in Translation Dialog
    // HTML engine considers Monospaced/Monospace to be the same Font
    // Java engine recognizes only Monospaced
    public static final String FONT_NAME_MONOSPACED = &quot;Monospaced&quot;;

<span class="fc" id="L169">    public static final Font FONT_MONO_NON_ASIAN = new Font(</span>
        UiUtil.FONT_NAME_MONO_NON_ASIAN,
        Font.PLAIN,
<span class="fc" id="L172">        UIManager.getDefaults().getFont(&quot;TextArea.font&quot;).getSize() + 2</span>
    );
    
<span class="fc" id="L175">    public static final Font FONT_MONO_ASIAN = new Font(</span>
        UiUtil.FONT_NAME_MONO_ASIAN,
        Font.PLAIN,
<span class="fc" id="L178">        UIManager.getDefaults().getFont(TEXTPANE_FONT).getSize()</span>
    );
    
<span class="fc" id="L181">    public static final Font FONT_NON_MONO = new Font(</span>
        &quot;Segoe UI&quot;,
        Font.PLAIN,
<span class="fc" id="L184">        UIManager.getDefaults().getFont(TEXTPANE_FONT).getSize()</span>
    );
    
<span class="fc" id="L187">    public static final Font FONT_NON_MONO_BIG = new Font(</span>
<span class="fc" id="L188">        UIManager.getDefaults().getFont(&quot;TextField.font&quot;).getName(),</span>
        Font.PLAIN,
<span class="fc" id="L190">        UIManager.getDefaults().getFont(&quot;TextField.font&quot;).getSize() + 2</span>
    );

    public static final String CHUNK_VISIBLE = &quot;chunk_visible&quot;;
    public static final String BINARY_VISIBLE = &quot;binary_visible&quot;;
    public static final String NETWORK_VISIBLE = &quot;header_visible&quot;;
    public static final String JAVA_VISIBLE = &quot;java_visible&quot;;
    
    private UiUtil() {
        // Utility class
    }
    
    /**
     * Change the default style of various components.
     */
    public static void prepareGUI() {
        
<span class="fc" id="L207">        loadFonts();</span>
<span class="fc" id="L208">        configureToolTip();</span>
<span class="fc" id="L209">        configureButton();</span>
<span class="fc" id="L210">        configureMenu();</span>
<span class="fc" id="L211">        configureTabbedPane();</span>
        
<span class="fc" id="L213">        UIManager.put(&quot;FileChooser.listFont&quot;, UiUtil.FONT_NON_MONO);</span>
<span class="fc" id="L214">        UIManager.put(&quot;FileChooser.listViewBorder&quot;, BorderFactory.createCompoundBorder(</span>
<span class="fc" id="L215">            BorderFactory.createLineBorder(UiUtil.COLOR_BLU),</span>
<span class="fc" id="L216">            BorderFactory.createMatteBorder(2,2,2,2, Color.WHITE)</span>
        ));

<span class="fc" id="L219">        configureText();</span>
<span class="fc" id="L220">        configureTable();</span>
<span class="fc" id="L221">        configureTree();</span>
<span class="fc" id="L222">        configureProgressBar();</span>
<span class="fc" id="L223">        configureComboBox();</span>
        
<span class="fc" id="L225">        UIManager.put(&quot;swing.boldMetal&quot;, Boolean.FALSE);</span>
<span class="fc" id="L226">    }</span>

    private static void loadFonts() {
        
<span class="fc" id="L230">        var graphicsEnvironment = GraphicsEnvironment.getLocalGraphicsEnvironment();</span>
        
<span class="fc" id="L232">        try (InputStream fontStream = new BufferedInputStream(Objects.requireNonNull(UiUtil.class.getClassLoader().getResourceAsStream(&quot;swing/font/UbuntuMono-R-ctrlchar.ttf&quot;)))) {</span>
            
<span class="fc" id="L234">            var ubuntuFont = Font.createFont(Font.TRUETYPE_FONT, fontStream);</span>
<span class="fc" id="L235">            graphicsEnvironment.registerFont(ubuntuFont);</span>
            
<span class="nc" id="L237">        } catch (FontFormatException | IOException e) {</span>
<span class="nc" id="L238">            LOGGER.log(LogLevelUtil.CONSOLE_ERROR, &quot;Loading Font Ubuntu Mono with control characters failed&quot;, e);</span>
<span class="fc" id="L239">        }</span>
<span class="fc" id="L240">    }</span>

    private static void configureText() {
        
        // Custom text component
        // Admin page
<span class="fc" id="L246">        UIManager.put(&quot;TextPane.selectionBackground&quot;, UiUtil.COLOR_FOCUS_GAINED);</span>
<span class="fc" id="L247">        UIManager.put(TEXTPANE_FONT, UiUtil.FONT_MONO_NON_ASIAN);</span>
<span class="fc" id="L248">        UIManager.put(&quot;TextPane.selectionBackground&quot;, UiUtil.COLOR_FOCUS_GAINED);</span>
        
<span class="fc" id="L250">        UIManager.put(&quot;TextField.border&quot;, UiUtil.BORDER_BLU);</span>
<span class="fc" id="L251">        UIManager.put(&quot;TextField.selectionBackground&quot;, UiUtil.COLOR_FOCUS_GAINED);</span>
        
<span class="fc" id="L253">        UIManager.put(&quot;EditorPane.selectionBackground&quot;, UiUtil.COLOR_FOCUS_GAINED);</span>
        
<span class="fc" id="L255">        UIManager.put(&quot;TextArea.selectionBackground&quot;, UiUtil.COLOR_FOCUS_GAINED);</span>
<span class="fc" id="L256">        UIManager.put(&quot;TextArea.font&quot;, UiUtil.FONT_MONO_NON_ASIAN);</span>

        // Custom Label
<span class="fc" id="L259">        UIManager.put(&quot;Label.font&quot;, UiUtil.FONT_NON_MONO);</span>
<span class="fc" id="L260">        UIManager.put(&quot;Label.selectionBackground&quot;, UiUtil.COLOR_FOCUS_GAINED);</span>
<span class="fc" id="L261">    }</span>

    private static void configureButton() {
        
<span class="fc" id="L265">        UIManager.put(&quot;Button.font&quot;, UiUtil.FONT_NON_MONO);</span>
<span class="fc" id="L266">        UIManager.put(&quot;CheckBox.font&quot;, UiUtil.FONT_NON_MONO);</span>
<span class="fc" id="L267">        UIManager.put(&quot;RadioButton.font&quot;, UiUtil.FONT_NON_MONO);</span>
<span class="fc" id="L268">        UIManager.put(&quot;TitledBorder.font&quot;, UiUtil.FONT_NON_MONO);</span>

<span class="fc" id="L270">        UIManager.put(&quot;Spinner.arrowButtonBorder&quot;, UiUtil.BORDER_BLU);</span>
<span class="fc" id="L271">        UIManager.put(&quot;Spinner.border&quot;, BorderFactory.createLineBorder(UiUtil.COLOR_COMPONENT_BORDER, 1, false));</span>
<span class="fc" id="L272">        UIManager.put(&quot;Spinner.disableOnBoundaryValues&quot;, Boolean.TRUE);</span>
        
        // Custom button
        // Change border of button in default Save as, Confirm dialogs
<span class="fc" id="L276">        UIManager.put(&quot;Button.border&quot;, UiUtil.BORDER_BLU);</span>
<span class="fc" id="L277">        UIManager.put(&quot;Button.select&quot;, new Color(155, 193, 232));</span>
        
        // Change border of button in Save as dialog
<span class="fc" id="L280">        UIManager.put(&quot;ToggleButton.border&quot;, UiUtil.BORDER_BLU);</span>
        
<span class="fc" id="L282">        UIManager.put(&quot;Button.defaultButtonFollowsFocus&quot;, Boolean.TRUE);</span>
<span class="fc" id="L283">    }</span>

    private static void configureToolTip() {
        
        // Custom tooltip
        // timer before showing tooltip
<span class="fc" id="L289">        ToolTipManager.sharedInstance().setInitialDelay(750);</span>
        // timer before closing automatically tooltip
<span class="fc" id="L291">        ToolTipManager.sharedInstance().setDismissDelay(30000);</span>
        // timer used when mouse move to another component, show tooltip immediately if timer is not expired
<span class="fc" id="L293">        ToolTipManager.sharedInstance().setReshowDelay(1);</span>

<span class="fc" id="L295">        UIManager.put(&quot;ToolTip.background&quot;, new Color(255, 255, 225));</span>
<span class="fc" id="L296">        UIManager.put(&quot;ToolTip.backgroundInactive&quot;, new Color(255, 255, 225));</span>
<span class="fc" id="L297">        UIManager.put(&quot;ToolTip.foreground&quot;, Color.BLACK);</span>
<span class="fc" id="L298">        UIManager.put(&quot;ToolTip.foregroundInactive&quot;, Color.BLACK);</span>
<span class="fc" id="L299">        UIManager.put(&quot;ToolTip.font&quot;, UiUtil.FONT_NON_MONO);</span>
<span class="fc" id="L300">    }</span>

    private static void configureTabbedPane() {
        
        // Custom tab
<span class="fc" id="L305">        UIManager.put(&quot;TabbedPane.contentAreaColor&quot;, UiUtil.FONT_MONO_NON_ASIAN);</span>
<span class="fc" id="L306">        UIManager.put(&quot;TabbedPane.font&quot;, UiUtil.FONT_NON_MONO);</span>
        // margin of current tab panel
<span class="fc" id="L308">        UIManager.put(&quot;TabbedPane.contentBorderInsets&quot;, new Insets(0, 0, 0, 0));</span>
        // margin above tabs
<span class="fc" id="L310">        UIManager.put(&quot;TabbedPane.tabAreaInsets&quot;, new Insets(3, 2, 0, 2));</span>
        // margin around tab name
<span class="fc" id="L312">        UIManager.put(&quot;TabbedPane.tabInsets&quot;, new Insets(2, 3 + 5, 2, 3));</span>
        // lighter unselected tab border
<span class="fc" id="L314">        UIManager.put(&quot;TabbedPane.darkShadow&quot;, new Color(190,198,205));</span>
<span class="fc" id="L315">    }</span>

    private static void configureMenu() {
        
        // Prevent green glitch on Mac menu
<span class="pc bpc" id="L320" title="1 of 2 branches missed.">        if (!SystemUtils.IS_OS_MAC) {</span>
            
            // No bold for menu + round corner
<span class="fc" id="L323">            UIManager.put(&quot;Menu.font&quot;, UiUtil.FONT_NON_MONO);</span>
<span class="fc" id="L324">            UIManager.put(&quot;Menu.selectionBackground&quot;, UiUtil.COLOR_FOCUS_GAINED);</span>
<span class="fc" id="L325">            UIManager.put(&quot;Menu.borderPainted&quot;, false);</span>
<span class="fc" id="L326">            UIManager.put(&quot;PopupMenu.font&quot;, UiUtil.FONT_NON_MONO);</span>
<span class="fc" id="L327">            UIManager.put(&quot;RadioButtonMenuItem.selectionBackground&quot;, UiUtil.COLOR_FOCUS_GAINED);</span>
<span class="fc" id="L328">            UIManager.put(&quot;RadioButtonMenuItem.font&quot;, UiUtil.FONT_NON_MONO);</span>
<span class="fc" id="L329">            UIManager.put(&quot;RadioButtonMenuItem.borderPainted&quot;, false);</span>
<span class="fc" id="L330">            UIManager.put(&quot;MenuItem.selectionBackground&quot;, UiUtil.COLOR_FOCUS_GAINED);</span>
<span class="fc" id="L331">            UIManager.put(&quot;MenuItem.font&quot;, UiUtil.FONT_NON_MONO);</span>
<span class="fc" id="L332">            UIManager.put(&quot;MenuItem.borderPainted&quot;, false);</span>
<span class="fc" id="L333">            UIManager.put(&quot;MenuItem.disabledAreNavigable&quot;, Boolean.TRUE);</span>
            
<span class="fc" id="L335">            UIManager.put(&quot;CheckBoxMenuItem.selectionBackground&quot;, UiUtil.COLOR_FOCUS_GAINED);</span>
<span class="fc" id="L336">            UIManager.put(&quot;CheckBoxMenuItem.font&quot;, UiUtil.FONT_NON_MONO);</span>
<span class="fc" id="L337">            UIManager.put(&quot;CheckBoxMenuItem.borderPainted&quot;, false);</span>
<span class="fc" id="L338">            UIManager.put(&quot;CheckBoxMenuItem.checkIcon&quot;, new CheckBoxIcon());</span>
        }
<span class="fc" id="L340">    }</span>

    private static void configureTable() {
        
        // Custom table
<span class="fc" id="L345">        UIManager.put(&quot;Table.font&quot;, UiUtil.FONT_NON_MONO);</span>
<span class="fc" id="L346">        UIManager.put(&quot;TableHeader.font&quot;, UiUtil.FONT_NON_MONO);</span>
<span class="fc" id="L347">        UIManager.put(&quot;Table.selectionBackground&quot;, UiUtil.COLOR_FOCUS_GAINED);</span>
        
<span class="fc" id="L349">        UIManager.put(&quot;Table.focusCellHighlightBorder&quot;,</span>
<span class="fc" id="L350">            BorderFactory.createCompoundBorder(</span>
<span class="fc" id="L351">                new AbstractBorder() {</span>
                    
                    @Override
                    public void paintBorder(Component comp, Graphics g, int x, int y, int w, int h) {
                        
<span class="fc" id="L356">                        Graphics2D g2D = (Graphics2D) g;</span>
<span class="fc" id="L357">                        g2D.setColor(Color.GRAY);</span>
<span class="fc" id="L358">                        g2D.setStroke(new BasicStroke(1, BasicStroke.CAP_BUTT, BasicStroke.JOIN_BEVEL, 0, new float[]{1}, 0));</span>
                        
                        // Fix #42291: InternalError on drawRect()
                        try {
<span class="fc" id="L362">                            g2D.drawRect(x, y, w - 1, h - 1);</span>
<span class="nc" id="L363">                        } catch (InternalError e) {</span>
<span class="nc" id="L364">                            LOGGER.log(LogLevelUtil.CONSOLE_JAVA, e, e);</span>
<span class="fc" id="L365">                        }</span>
<span class="fc" id="L366">                    }</span>
                },
<span class="fc" id="L368">                BorderFactory.createEmptyBorder(0, 1, 0, 0)</span>
            )
        );
<span class="fc" id="L371">    }</span>

    private static void configureTree() {
        
        // Custom tree
<span class="fc" id="L376">        UIManager.put(&quot;Tree.expandedIcon&quot;, new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/expanded.png&quot;))));</span>
<span class="fc" id="L377">        UIManager.put(&quot;Tree.collapsedIcon&quot;, new ImageIcon(Objects.requireNonNull(UiUtil.class.getClassLoader().getResource(&quot;swing/images/icons/collapsed.png&quot;))));</span>
<span class="fc" id="L378">        UIManager.put(&quot;Tree.lineTypeDashed&quot;, true);</span>
        
        // No default icon for tree nodes
<span class="fc" id="L381">        UIManager.put(&quot;Tree.leafIcon&quot;, new ImageIcon());</span>
<span class="fc" id="L382">        UIManager.put(&quot;Tree.openIcon&quot;, new ImageIcon());</span>
<span class="fc" id="L383">        UIManager.put(&quot;Tree.closedIcon&quot;, new ImageIcon());</span>
<span class="fc" id="L384">    }</span>

    private static void configureComboBox() {
        
        // Custom ComboBox
<span class="fc" id="L389">        UIManager.put(&quot;ComboBox.font&quot;, UiUtil.FONT_NON_MONO);</span>
<span class="fc" id="L390">        UIManager.put(&quot;ComboBox.selectionBackground&quot;, UiUtil.COLOR_FOCUS_GAINED);</span>
        
        // Use ColorUIResource to preserve the background color for arrow
<span class="fc" id="L393">        UIManager.put(&quot;ComboBox.background&quot;, new ColorUIResource(Color.WHITE));</span>
<span class="fc" id="L394">        UIManager.put(&quot;ComboBox.border&quot;, UiUtil.BORDER_BLU);</span>
<span class="fc" id="L395">        UIManager.put(&quot;ComboBoxUI&quot;, CustomBasicComboBoxUI.class.getName());</span>
<span class="fc" id="L396">    }</span>

    private static void configureProgressBar() {
        
        // Custom progress bar
<span class="fc" id="L401">        UIManager.put(&quot;ProgressBar.border&quot;, BorderFactory.createCompoundBorder(</span>
<span class="fc" id="L402">            BorderFactory.createEmptyBorder(3, 0, 4, 0),</span>
<span class="fc" id="L403">            BorderFactory.createCompoundBorder(</span>
<span class="fc" id="L404">                BorderFactory.createLineBorder(Color.GRAY),</span>
<span class="fc" id="L405">                BorderFactory.createLineBorder(Color.WHITE)</span>
            )
        ));
        
<span class="fc" id="L409">        UIManager.put(&quot;ProgressBar.foreground&quot;, new Color(136, 183, 104));</span>
<span class="fc" id="L410">        UIManager.put(&quot;ProgressBar.background&quot;, UIManager.get(&quot;Tree.background&quot;));</span>
<span class="fc" id="L411">    }</span>

    /**
     * Icons for application window.
     * @return List of a 16x16 (default) and 32x32 icon (alt-tab, taskbar)
     */
    public static List&lt;Image&gt; getIcons() {
        
<span class="fc" id="L419">        List&lt;Image&gt; images = new ArrayList&lt;&gt;();</span>
        
        // Fix #2154: NoClassDefFoundError on read()
        try {
<span class="fc" id="L423">            images.add(ImageIO.read(Objects.requireNonNull(UiUtil.URL_ICON_128)));</span>
<span class="fc" id="L424">            images.add(ImageIO.read(Objects.requireNonNull(UiUtil.URL_ICON_96)));</span>
<span class="fc" id="L425">            images.add(ImageIO.read(Objects.requireNonNull(UiUtil.URL_ICON_32)));</span>
<span class="fc" id="L426">            images.add(ImageIO.read(Objects.requireNonNull(UiUtil.URL_ICON_16)));</span>
            
<span class="nc" id="L428">        } catch (NoClassDefFoundError | IOException e) {</span>
<span class="nc" id="L429">            LOGGER.log(LogLevelUtil.CONSOLE_JAVA, e, e);</span>
<span class="fc" id="L430">        }</span>
        
<span class="fc" id="L432">        return images;</span>
    }
    
    public static void drawPlaceholder(JTextComponent textComponent, Graphics g, String placeholderText) {
<span class="fc" id="L436">        drawPlaceholder(textComponent, g, placeholderText, g.getFontMetrics().getAscent() + 2);</span>
<span class="fc" id="L437">    }</span>
    
    public static void drawPlaceholder(JTextComponent textComponent, Graphics g, String placeholderText, int y) {
        
<span class="fc" id="L441">        int w = textComponent.getWidth();</span>
        
<span class="fc" id="L443">        ((Graphics2D) g).setRenderingHint(RenderingHints.KEY_TEXT_ANTIALIASING, RenderingHints.VALUE_TEXT_ANTIALIAS_ON);</span>
        
<span class="fc" id="L445">        var ins = textComponent.getInsets();</span>
<span class="fc" id="L446">        var fm = g.getFontMetrics();</span>
        
<span class="fc" id="L448">        int c0 = textComponent.getBackground().getRGB();</span>
<span class="fc" id="L449">        int c1 = textComponent.getForeground().getRGB();</span>
<span class="fc" id="L450">        var m = 0xfefefefe;</span>
<span class="fc" id="L451">        int c2 = ((c0 &amp; m) &gt;&gt;&gt; 1) + ((c1 &amp; m) &gt;&gt;&gt; 1);</span>
        
<span class="fc" id="L453">        g.setColor(new Color(c2, true));</span>
<span class="fc" id="L454">        g.setFont(textComponent.getFont().deriveFont(Font.ITALIC));</span>

<span class="fc" id="L456">        g.drawString(</span>
            placeholderText,
<span class="pc bpc" id="L458" title="1 of 2 branches missed.">            ComponentOrientation.RIGHT_TO_LEFT.equals(textComponent.getComponentOrientation())</span>
<span class="nc" id="L459">            ? w - (fm.stringWidth(placeholderText) + ins.left + 2)</span>
<span class="fc" id="L460">            : ins.left + 2,</span>
            y
        );
<span class="fc" id="L463">    }</span>
    
    public static void initialize(JTextComponent component) {

<span class="fc" id="L467">        component.setCaret(new DefaultCaret() {</span>
            
            @Override
            public void setSelectionVisible(boolean visible) {
                
<span class="fc" id="L472">                super.setSelectionVisible(true);</span>
<span class="fc" id="L473">            }</span>
        });

        // Side effect: disable caret blink, editable texts must restore blink rate
<span class="fc" id="L477">        component.addFocusListener(new FocusListener() {</span>

            @Override
            public void focusLost(FocusEvent e) {

<span class="fc" id="L482">                component.setSelectionColor(UiUtil.COLOR_FOCUS_LOST);</span>
<span class="fc" id="L483">                component.revalidate();</span>
<span class="fc" id="L484">                component.repaint();</span>
<span class="fc" id="L485">            }</span>

            @Override
            public void focusGained(FocusEvent e) {

<span class="fc" id="L490">                component.setSelectionColor(UiUtil.COLOR_FOCUS_GAINED);</span>
<span class="fc" id="L491">                component.revalidate();</span>
<span class="fc" id="L492">                component.repaint();</span>
<span class="fc" id="L493">            }</span>
        });
        
<span class="fc" id="L496">        component.getActionMap().put(DefaultEditorKit.deletePrevCharAction, new DeletePrevCharAction());</span>
<span class="fc" id="L497">        component.getActionMap().put(DefaultEditorKit.deleteNextCharAction, new DeleteNextCharAction());</span>
<span class="fc" id="L498">    }</span>
    
    /**
     * End the thread doing coloring.
     * @param textPane which coloring has to stop.
     */
    public static void stopDocumentColorer(JTextPane textPane) {
        
<span class="pc bpc" id="L506" title="1 of 2 branches missed.">        if (textPane.getStyledDocument() instanceof HighlightedDocument) {</span>
            
<span class="nc" id="L508">            HighlightedDocument oldDocument = (HighlightedDocument) textPane.getStyledDocument();</span>
<span class="nc" id="L509">            oldDocument.stopColorer();</span>
        }
<span class="fc" id="L511">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>