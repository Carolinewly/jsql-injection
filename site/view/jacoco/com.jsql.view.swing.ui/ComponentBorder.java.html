<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ComponentBorder.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">view</a> &gt; <a href="index.source.html" class="el_package">com.jsql.view.swing.ui</a> &gt; <span class="el_source">ComponentBorder.java</span></div><h1>ComponentBorder.java</h1><pre class="source lang-java linenums">package com.jsql.view.swing.ui;

import com.jsql.util.I18nUtil;

import javax.swing.*;
import javax.swing.border.Border;
import javax.swing.border.CompoundBorder;
import java.awt.*;

/**
 * The ComponentBorder class allows you to place a real component in
 * the space reserved for painting the Border of a component.
 *
 * This class takes advantage of the knowledge that all Swing components are
 * also Containers. By default, the layout manager is null, so we should be
 * able to place a child component anywhere in the parent component. In order
 * to prevent the child component from painting over top of the parent
 * component a Border is added to the parent component such that the insets of
 * the Border will reserve space for the child component to be painted without
 * affecting the parent component.
 */
public class ComponentBorder implements Border {
    
<span class="fc" id="L24">    public enum Edge {</span>
<span class="fc" id="L25">        TOP,</span>
<span class="fc" id="L26">        LEFT,</span>
<span class="fc" id="L27">        BOTTOM,</span>
<span class="fc" id="L28">        RIGHT</span>
    }

    public static final float LEADING  = 0.0f;
    public static final float CENTER   = 0.5f;
    public static final float TRAILING = 1.0f;

    private JComponent parent;
    private final JComponent component;
    private Edge edge;
    private float alignment;
<span class="fc" id="L39">    private int gap = 5;</span>
<span class="fc" id="L40">    private boolean adjustInsets = true;</span>
<span class="fc" id="L41">    private Insets borderInsets = new Insets(0, 0, 0, 0);</span>
    
    private int addX;
    private int addY;

    /**
     * Convenience constructor that uses the default edge (Edge.RIGHT) and
     * alignment (CENTER).
     * @param component the component to be added in the Border area
     */
    public ComponentBorder(JComponent component) {
<span class="nc" id="L52">        this(component, Edge.RIGHT);</span>
<span class="nc" id="L53">    }</span>

    public ComponentBorder(JComponent component, int addX, int addY) {
        
<span class="fc" id="L57">        this(component, Edge.RIGHT);</span>

<span class="fc" id="L59">        this.addX = addX;</span>
<span class="fc" id="L60">        this.addY = addY;</span>
<span class="fc" id="L61">    }</span>

    /**
     * Convenience constructor that uses the default alignment (CENTER).
     * @param component the component to be added in the Border area
     * @param edge a valid Edge enum of TOP, LEFT, BOTTOM, RIGHT
     */
    public ComponentBorder(JComponent component, Edge edge) {
<span class="fc" id="L69">        this(component, edge, CENTER);</span>
<span class="fc" id="L70">    }</span>

    /**
     * Main constructor to create a ComponentBorder.
     * @param component the component to be added in the Border area
     * @param edge a valid Edge enum of TOP, LEFT, BOTTOM, RIGHT
     * @param alignment the alignment of the component along the
     * specified Edge. Must be in the range 0 - 1.0.
     */
<span class="fc" id="L79">    public ComponentBorder(JComponent component, Edge edge, float alignment) {</span>
        
<span class="fc" id="L81">        this.component = component;</span>
<span class="fc" id="L82">        component.setSize(component.getPreferredSize());</span>
<span class="fc" id="L83">        component.setCursor(Cursor.getDefaultCursor());</span>
<span class="fc" id="L84">        this.setEdge(edge);</span>
<span class="fc" id="L85">        this.setAlignment(alignment);</span>
<span class="fc" id="L86">    }</span>

    public boolean isAdjustInsets() {
<span class="nc" id="L89">        return this.adjustInsets;</span>
    }

    public void setAdjustInsets(boolean adjustInsets) {
<span class="nc" id="L93">        this.adjustInsets = adjustInsets;</span>
<span class="nc" id="L94">    }</span>

    /**
     * Get the component alignment along the Border Edge.
     * @return the alignment
     */
    public float getAlignment() {
<span class="nc" id="L101">        return this.alignment;</span>
    }

    /**
     * Set the component alignment along the Border Edge.
     * @param alignment a value in the range 0 - 1.0. Standard values would be
     *                     CENTER (default), LEFT and RIGHT.
     */
    public void setAlignment(float alignment) {
        
<span class="pc bpc" id="L111" title="1 of 2 branches missed.">        if (alignment &gt; 1.0f) {</span>
            
<span class="nc" id="L113">            this.alignment = 1.0f;</span>
            
        } else {

<span class="fc" id="L117">            this.alignment = Math.max(alignment, 0.0f);</span>
        }
<span class="fc" id="L119">    }</span>

    /**
     * Get the Edge the component is positioned along.
     * @return the Edge
     */
    public Edge getEdge() {
<span class="nc" id="L126">        return this.edge;</span>
    }

    /**
     * Set the Edge the component is positioned along.
     * @param edge the Edge the component is position on.
     */
    public void setEdge(Edge edge) {
<span class="fc" id="L134">        this.edge = edge;</span>
<span class="fc" id="L135">    }</span>

    /**
     * Get the gap between the border component and the parent component.
     * @return the gap in pixels.
     */
    public int getGap() {
<span class="nc" id="L142">        return this.gap;</span>
    }

    /**
     * Set the gap between the border component and the parent component.
     * @param gap the gap in pixels (default is 5)
     */
    public void setGap(int gap) {
<span class="nc" id="L150">        this.gap = gap;</span>
<span class="nc" id="L151">    }</span>

    @Override
    public Insets getBorderInsets(Component c) {
<span class="fc" id="L155">        return this.borderInsets;</span>
    }

    @Override
    public boolean isBorderOpaque() {
<span class="nc" id="L160">        return false;</span>
    }

    /**
     * In this case a real component is to be painted. Setting the location
     * of the component will cause it to be painted at that location.
     */
    @Override
    public void paintBorder(Component c, Graphics g, int x, int y, int width, int height) {
        
<span class="pc bpc" id="L170" title="1 of 2 branches missed.">        float x2 = ComponentOrientation.RIGHT_TO_LEFT.equals(ComponentOrientation.getOrientation(I18nUtil.getLocaleDefault()))</span>
<span class="nc" id="L171">            ? this.component.getWidth() * this.component.getAlignmentX() + x</span>
<span class="fc" id="L172">            : (width - this.component.getWidth()) * this.component.getAlignmentX() + x;</span>
        
<span class="fc" id="L174">        float y2 = (height - this.component.getHeight()) * this.component.getAlignmentY() + y;</span>
        
<span class="fc" id="L176">        this.component.setLocation((int) x2 + this.addX, (int) y2 + this.addY);</span>
<span class="fc" id="L177">    }</span>

    /**
     * Install this Border on the specified component by replacing the
     * existing Border with a CompoundBorder containing the original Border
     * and our ComponentBorder
     *
     * This method should only be invoked once all the properties of this
     * class have been set. Installing the Border more than once will cause
     * unpredictable results.
     */
    public void install(JComponent parent) {
        
<span class="fc" id="L190">        this.parent = parent;</span>

<span class="fc" id="L192">        this.determineInsetsAndAlignment();</span>

        // Add this Border to the parent
<span class="fc" id="L195">        var current = parent.getBorder();</span>

<span class="pc bpc" id="L197" title="1 of 2 branches missed.">        if (current == null) {</span>
<span class="nc" id="L198">            parent.setBorder(this);</span>
        } else {
            
<span class="fc" id="L201">            var compound = new CompoundBorder(current, this);</span>
<span class="fc" id="L202">            parent.setBorder(compound);</span>
        }

        // Add component to the parent
<span class="fc" id="L206">        parent.add(this.component);</span>
<span class="fc" id="L207">    }</span>

    /**
     * The insets need to be determined so they are included in the preferred
     * size of the component the Border is attached to.
     *
     * The alignment of the component is determined here so it doesn't need
     * to be recalculated every time the Border is painted.
     */
    private void determineInsetsAndAlignment() {
        
<span class="fc" id="L218">        this.borderInsets = new Insets(0, 0, 0, 0);</span>

        // The insets will only be updated for the edge the component will be
        // displayed on.
        //
        // The X, Y alignment of the component is controlled by both the edge
        // and alignment parameters
<span class="pc bpc" id="L225" title="1 of 2 branches missed.">        if (this.edge == Edge.TOP) {</span>
            
<span class="nc" id="L227">            this.borderInsets.top = this.component.getPreferredSize().height + this.gap;</span>
<span class="nc" id="L228">            this.component.setAlignmentX(this.alignment);</span>
<span class="nc" id="L229">            this.component.setAlignmentY(0.0f);</span>
            
<span class="pc bpc" id="L231" title="1 of 2 branches missed.">        } else if (this.edge == Edge.BOTTOM) {</span>
            
<span class="nc" id="L233">            this.borderInsets.bottom = this.component.getPreferredSize().height + this.gap;</span>
<span class="nc" id="L234">            this.component.setAlignmentX(this.alignment);</span>
<span class="nc" id="L235">            this.component.setAlignmentY(1.0f);</span>
            
<span class="pc bpc" id="L237" title="1 of 2 branches missed.">        } else if (this.edge == Edge.LEFT) {</span>
            
<span class="nc" id="L239">            this.borderInsets.left = this.component.getPreferredSize().width + this.gap;</span>
<span class="nc" id="L240">            this.component.setAlignmentX(0.0f);</span>
<span class="nc" id="L241">            this.component.setAlignmentY(this.alignment);</span>
            
<span class="pc bpc" id="L243" title="1 of 2 branches missed.">        } else if (this.edge == Edge.RIGHT) {</span>
            
<span class="fc" id="L245">            this.borderInsets.right = this.component.getPreferredSize().width + this.gap;</span>
<span class="fc" id="L246">            this.component.setAlignmentX(1.0f);</span>
<span class="fc" id="L247">            this.component.setAlignmentY(this.alignment);</span>
        }

<span class="pc bpc" id="L250" title="1 of 2 branches missed.">        if (this.adjustInsets) {</span>
<span class="fc" id="L251">            this.adjustBorderInsets();</span>
        }
<span class="fc" id="L253">    }</span>

    /**
     * The complimentary edges of the Border may need to be adjusted to allow
     * the component to fit completely in the bounds of the parent component.
     */
    private void adjustBorderInsets() {
        
<span class="fc" id="L261">        var parentInsets = this.parent.getInsets();</span>

        // May need to adjust the height of the parent component to fit
        // the component in the Border
<span class="pc bpc" id="L265" title="3 of 4 branches missed.">        if (this.edge == Edge.RIGHT || this.edge == Edge.LEFT) {</span>
            
<span class="fc" id="L267">            int parentHeight = this.parent.getPreferredSize().height - parentInsets.top - parentInsets.bottom;</span>
<span class="fc" id="L268">            int diff = this.component.getHeight() - parentHeight;</span>

<span class="fc bfc" id="L270" title="All 2 branches covered.">            if (diff &gt; 0) {</span>
<span class="fc" id="L271">                int topDiff = (int) (diff * this.alignment);</span>
<span class="fc" id="L272">                int bottomDiff = diff - topDiff;</span>
<span class="fc" id="L273">                this.borderInsets.top += topDiff;</span>
<span class="fc" id="L274">                this.borderInsets.bottom += bottomDiff;</span>
            }
        }

        // May need to adjust the width of the parent component to fit
        // the component in the Border
<span class="pc bpc" id="L280" title="2 of 4 branches missed.">        if (this.edge == Edge.TOP || this.edge == Edge.BOTTOM) {</span>
            
<span class="nc" id="L282">            int parentWidth = this.parent.getPreferredSize().width - parentInsets.left - parentInsets.right;</span>
<span class="nc" id="L283">            int diff = this.component.getWidth() - parentWidth;</span>

<span class="nc bnc" id="L285" title="All 2 branches missed.">            if (diff &gt; 0) {</span>
<span class="nc" id="L286">                int leftDiff = (int) (diff * this.alignment);</span>
<span class="nc" id="L287">                int rightDiff = diff - leftDiff;</span>
<span class="nc" id="L288">                this.borderInsets.left += leftDiff;</span>
<span class="nc" id="L289">                this.borderInsets.right += rightDiff;</span>
            }
        }
<span class="fc" id="L292">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>